<script>
// 在渲染函数中统一 X 轴
function renderCharts(data) {
    const labels = data.strikes.map(s => s.strike);
    const gexValues = data.strikes.map(s => s.netGex);
    const volOiValues = data.strikes.map(s => s.volOiRatio);

    // GEX Chart
    new Chart(ctxGex, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Net GEX',
                data: gexValues,
                backgroundColor: gexValues.map(v => v >= 0 ? '#00d084' : '#ff4757')
            }]
        },
        options: {
            scales: { x: { display: true, grid: { color: '#1e2d42' } } },
            plugins: {
                annotation: {
                    annotations: {
                        spot: { type: 'line', xMin: data.spotPrice, xMax: data.spotPrice, borderColor: 'white', borderDash: [5,5] },
                        flip: { type: 'line', xMin: data.gammaFlip, xMax: data.gammaFlip, borderColor: '#ffd32a', borderDash: [2,2] }
                    }
                }
            }
        }
    });

    // 0DTE Vol/OI Chart (确保 X 轴与上方完全对齐)
    new Chart(ctxVol, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{ label: 'Vol/OI Ratio', data: volOiValues, borderColor: '#74b9ff' }]
        },
        options: {
            scales: { x: { display: false } } // 隐藏 X 轴文字但保持刻度对齐
        }
    });
}
</script>
